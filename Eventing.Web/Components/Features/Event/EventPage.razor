@page "/event"
@using Eventing.Web.Components.Features.Event.Enums
@layout EmptyLayout
@rendermode InteractiveServer

<PageTitle>Event</PageTitle>

@if (IsLoading)
{
    <FluentProgress/>
}
else
{
    <FluentGrid Spacing="3" AdaptiveRendering="true" Justify="JustifyContent.FlexStart" Style="padding: 8px;">
        @foreach (var e in Events)
        {
            <FluentGridItem Id="@e.Id.ToString()" xs="12" sm="6" md="4" lg="3" xl="2">
                <div @onclick="@(() => OpenAttendeesPanelAsync(e.Id))" style="
                    background: #fff;
                    border-radius: 8px;
                    padding: 12px;
                    box-shadow: 0 1px 4px rgba(0,0,0,0.08);
                    display: flex;
                    flex-direction: column;
                    gap: 6px;
                    height: 100%;
                    cursor: pointer;">

                    <div>
                        <h3 style="
                            font-size: 1.1rem;
                            font-weight: 600;
                            margin: 0 0 4px;
                            color: #222;">@e.Title</h3>
                        <span style="
                            font-size: 0.85rem;
                            color: #666;">@e.StartTime.ToString("g") - @e.EndTime.ToString("g")</span>
                    </div>

                    <div style="flex-grow: 1;">
                        <p style="margin: 4px 0; font-size: 0.9rem; color: #444;">@e.Description</p>

                        <FluentStack Direction="Row" Spacing="2" VerticalAlignment="VerticalAlignment.Center">
                            @if (e.LocationType == LocationType.Virtual)
                            {
                                <FluentAnchor Href="@e.Location" IconStart="@(new Icons.Regular.Size16.Link())">
                                    @e.Location
                                </FluentAnchor>
                            }
                            else
                            {
                                <FluentIcon Value="@(new Icons.Regular.Size24.Location())"/>
                                <span style="color: #888;">@e.Location</span>
                            }
                        </FluentStack>
                        <p style="margin: 2px 0; font-size: 0.85rem; color: #555;">
                            <strong>Show Attendees:</strong> @(e.ShowAttendees ? "Yes" : "No")
                        </p>
                        <p style="margin: 2px 0; font-size: 0.75rem; color: #888;">
                            <FluentStack HorizontalAlignment="HorizontalAlignment.SpaceBetween"
                                         VerticalAlignment="VerticalAlignment.Center">
                                <div>
                                    <FluentPersona Name="@e.CreatedBy.Name"
                                                   ImageSize="30px">
                                    </FluentPersona>
                                </div>
                                <div>
                                    @e.CreatedAt
                                </div>
                            </FluentStack>
                        </p>
                        @if (e.UpdatedAt.HasValue)
                        {
                            <p style="margin: 2px 0; font-size: 0.75rem; color: #888;">
                                Updated at: @e.UpdatedAt
                            </p>
                        }
                    </div>
                </div>
            </FluentGridItem>
        }
    </FluentGrid>
}
